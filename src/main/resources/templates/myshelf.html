<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
  layout:decorate="~{layout/default}">

<th:block layout:fragment="css">
  <link rel="stylesheet" th:href="@{/css/myshelf.css}">
</th:block>

<th:block layout:fragment="script">
  <script th:src="@{/js/myshelf.js}"></script>
</th:block>


<div layout:fragment="content" id="page-content" data-index="3">

  <div class="top-back-wrapper">
    <div class="top-background-frame">
      <div class="top-background"></div>
    </div>
    <div class="top-back-title-wrapper">
      <img class="profile" src="/img/icon/person-circle.svg">
      <div class="top-back-title">
        <div class="top-back-title-name" th:text="${member.nickname}"></div>
        <div class="top-back-title-text">의 책장</div>
      </div>
      <img class="top-back-setting" src="/img/icon/setting-list.svg">
      <div class="top-back-point-wrapper">
        <img class="top-back-point-icon" src="/img/icon/bootstrap-fill.svg">
        <div class="top-back-point-text" th:text="${member.point} + ' 포인트'"></div>
      </div>
    </div>
  </div>

  <div class="top-space"></div>

  <div class="middle-nav-wrapper">
    <div class="middle-nav-container">
      <div class="middle-nav">
        <div class="active-index">책선반</div>
        <div>구매내역</div>
        <div>회원 정보</div>
      </div>
    </div>
  </div>


  <div class="meta-wrapper">

    <div class="shelf-wrapper content-box">
      <div class="favorite-wrapper">
        <div class="favorite-contents-wrapper">
          <div class="favorite-title-wrapper">
            <img class="favorite-title-icon" src="/img/icon/bookmark.svg">
            <div class="favorite-title">북마크한 책</div>
            <div class="favorite-number">12 ></div>
          </div>

          <div class="favorite-books">
            <div class="favorite-contents-null">북마크한 책이 자동으로 담깁니다.</div>
            <div><img src="/img/book-cover/11.jpg"></div>
            <div><img src="/img/book-cover/12.jpg"></div>
            <div><img src="/img/book-cover/13.jpg"></div>
            <div><img src="/img/book-cover/14.jpg"></div>
            <div><img src="/img/book-cover/15.jpg"></div>
          </div>
          <div class="favorite-shelf"></div>
        </div>
      </div>

      <div class="reading-wrapper">
        <div class="reading-contents-wrapper">
          <div class="reading-title-wrapper">
            <img class="reading-title-icon" src="/img/icon/book.svg">
            <div class="reading-title">구매한 책</div>
            <div class="reading-number">12 ></div>
          </div>

          <div class="reading-books">
            <div class="reading-contents-null">구매한 책이 자동으로 담깁니다.</div>
            <div><img src=""></div>
            <div><img src=""></div>
            <div><img src=""></div>
            <div><img src=""></div>
            <div><img src=""></div>
          </div>
          <div class="reading-shelf"></div>
        </div>
      </div>
    </div>


    <div class="order-info-wrapper content-box">

      <form class="order-list-title-detail-wrapper">
        <div class="detail-title">
          <span>상세조회</span>
          <img src="/img/icon/btn_dialog_close@2x.png">
        </div>
        <div class="order-list-title-detail-info">
          <li>조회기간 설정은 6개월 단위이며, 주문정보 조회는 최대 5년까지 가능합니다.</li>
          <li>필터 이용 시 선택한 주문정보만 조회 가능합니다.</li>
        </div>
        <div class="order-list-title-detail-range">
          <span class="detail-range-title">기간조회</span>
          <select id="detail-range-select">
            <option value="month-1" selected="selected">최근 1개월</option>
            <option value="month-2">최근 2개월</option>
            <option value="month-3">최근 3개월</option>
            <option value="month-6">최근 6개월</option>
            <option value="direct">직접입력</option>
          </select>
          <div class="detail-range-start-wrapper">
            <input class="detail-range-start" name="startDate" type="text">
            <img class="detail-range-start-icon" src="/img/icon/calendar.svg">
          </div>
          <div class="detail-range-between">~</div>
          <div class="detail-range-end-wrapper">
            <input class="detail-range-end" name="endDate" type="text">
            <img class="detail-range-end-icon" src="/img/icon/calendar.svg">
          </div>
        </div>
        <div class="order-list-detail-state">
          <span class="detail-state-title">구매 상태</span>
          <select name="orderState" id="detail-state-select">
            <option value="ALL" selected="selected">전체</option>
            <option value="ORDER">구매 완료</option>
            <option value="CANCEL">취소</option>
            <option value="SOLD">품절</option>
          </select>
        </div>
        <div class="order-list-detail-search">
          <span class="detail-search-title">검색</span>
          <input name="name" type="text" placeholder="상품명을 입력해주세요.">
        </div>
        <div class="order-list-detail-bottom">
          <div class="detail-bottom-reset">
            <img class="detail-bottom-reset-icon" src="/img/icon/arrow-clockwise.svg">
            <span>초기화</span>
          </div>
          <div class="detail-bottom-apply">
            <span>적용</span>
          </div>
        </div>
      </form>

      <div class="order-list-title-wrapper">
        <div class="order-list-title-inner-wrapper">
          <span class="order-list-title">주문 목록</span>
          <div class="order-list-title-button">
            <img src="/img/icon/calendar.svg">
            <span>상세조회</span>
          </div>
          <span class="order-list-title-info">최근 1개월 구매 내역입니다.</span>
        </div>
      </div>

      <div class="order-list-wrapper" id="order-box">
        <div class="order-list-top-box" th:if="${orderSearchDto}">
          <li class="order-list-top-box-title">
            <div>
              <span>주문 내역</span>
            </div>
          </li>
          <li>
            <div>
              <span th:text="${orderCount}"></span>
              <span>구매 완료</span>
            </div>
          </li>
          <li>
            <div>
              <span th:text="${cancelCount}"></span>
              <span>취소</span>
            </div>
          </li>
          <li>
            <div>
              <span th:text="${soldCount}"></span>
              <span>품절</span>
            </div>
          </li>
        </div>

        <div class="order-list-middle-box">
          <div class="order-list-middle-box-title">
            카드결제(간편결제,법인카드 포함) 취소 안내
          </div>
          <div class="order-list-middle-box-detail">
            <li>
              카드결제 취소 기간 안내<br>
              &nbsp;- 전체취소 : 당일 취소/환불 처리<br>
              &nbsp;- 부분취소 : 영업일 기준 3~5일 소요(당일 취소 포함)
            </li>
            <li>
              카드사 정책에 따라 주문당일 부분취소한 경우 당일 취소 및 환불 불가합니다.
            </li>
            <li>
              부분취소한 경우 카드사 승인 취소는 약 3~5일 소요됩니다.
            </li>
            <li>
              카드사에서 부분취소를 지원하지 않는 카드의 경우 승인취소가 아닌 예치금으로 환불됩니다.
            </li>
          </div>
        </div>

        <div class="order-list-contents-wrapper column-box">
          <div class="row-head">
            <div class="text text-1">주문일/주문번호</div>
            <div class="text-group">
              <div class="text">상품정보</div>
              <div class="text">상태</div>
              <div class="text">확인/신청</div>
            </div>
          </div>
          <div class="order-list-contents-null" th:if="${orders.totalElements == 0}">
            <img src="/img/icon/exclamation-circle-fill.svg">
            <span>조회되는 주문 정보가 없습니다.</span>
          </div>
          <div class="row" th:each="order : ${orders}"
               th:with="orderstate = ${T(com.cerdure.bookshelf.domain.enums.OrderState)}">
            <div class="date-code-box column-box">
              <div class="text">주문일자</div>
              <div class="date" th:text="${#temporals.format(order.regDate, 'yyyy-MM-dd')}"></div>
              <div class="text">주문번호</div>
              <div class="order-id" th:text="${order.id}"></div>
              <button class="order-detail-btn btn-gray">주문상세보기</button>
              <button class="order-cancel-btn btn-red" th:text="${order.orderState == orderstate.ORDER} ? '전체주문취소' : '취소된 주문'"></button>
            </div>
            <div class="item-box column-box">
              <div class="item row-box" th:each="item : ${order.orderItems}" th:with="book = ${item.book}">
                <div class="item-info row-box">
                  <img th:src="${book.imgPath}">
                  <div class="info column-box">
                    <div class="name" th:utext="${book.name}"></div>
                    <div class="row-box">
                      <div class="amount" th:text="${item.amount} + '권'"></div>
                      <div class="split">ㅣ</div>
                      <div class="price"
                        th:text="${#numbers.formatInteger(item.amount * book.discountPrice, 3, 'COMMA')} + '원'"></div>
                    </div>
                  </div>
                </div>
                <th:block th:switch="${item.orderState}">
                  <div class="state" th:case="${orderstate.ORDER}">결제완료</div>
                  <div class="state" th:case="${orderstate.CANCEL}">주문취소</div>
                  <div class="state" th:case="${orderstate.SOLD}">품절</div>
                </th:block>
                <div class="btn-box">
                  <th:block th:switch="${item.orderState}">
                    <button class="item-cancel-btn btn-red" th:case="${orderstate.ORDER}">주문취소</button>
                    <button class="disable btn-red" th:case="*">취소된 주문</button>
                  </th:block>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="controller-box">
          <span class="controller"
            th:with="start=${T(java.lang.Math).floor(orders.number/10)*10 + 1}, last=(${orders.totalPages})">
            <a th:class="${orders.first} ? 'disable'" th:onclick="'orderPageMove(' + ${orders.number} + ')'">
              <img class="controller-btn-left" src="/img/icon/btn_pagination_prev@2x.png">
            </a>
            <a th:onclick="'orderPageMove(1)'" th:if="${orders.totalPages < 4 ? false :orders.number > 1}"
               th:text="1" aria-label="First">
            </a>
            <span th:if="${orders.totalPages < 4 ? false :orders.number > 1}">...</span>
            <a th:each="page: ${#numbers.sequence(start, last)}" th:onclick="'orderPageMove(' + ${page} + ')'"
              th:if="${orders.first ? (page == 0 ? false : page < orders.number + 4) :
                (orders.last ? page > orders.number - 2 : (page < orders.number + 3) && (page > orders.number - 1))}"
              th:class="${page == orders.number + 1} ? 'index-active'" th:text="${page}">
            </a>
            <span th:if="${orders.totalPages < 4 ? false :orders.number < orders.totalPages - 2}">...</span>
            <a th:onclick="'orderPageMove(' + ${orders.totalPages} + ')'"
              th:if="${orders.totalPages < 4 ? false : orders.number < orders.totalPages - 2}"
              th:text="${orders.totalPages}" aria-label="Last">
            </a>
            <a th:class="${orders.last} ? 'disable'" th:onclick="'orderPageMove(' + ${orders.number +2} ')'">
              <img class="controller-btn-right" src="/img/icon/btn_pagination_next@2x.png">
            </a>
          </span>
        </div>

      </div>
    </div>

    <div class="member-info-wrapper content-box">

    </div>

    <div class="top-move-button">
      <div>∧</div>
      <div>TOP</div>
    </div>

  </div>

</html>